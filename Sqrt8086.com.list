EMU8086 GENERATED LISTING. MACHINE CODE <- SOURCE.
 
Sqrt8086.com -- emu8086 assembler version: 4.08  
 
[ 03-Dec-18  --  9:27:40 PM ] 
 
===================================================================================================
[LINE]     LOC: MACHINE CODE                          SOURCE
===================================================================================================
 
[   1]        :                                       Name "Sqrt8086"
[   2]        :                                       
[   3]        :                                       org 100h
[   4]        :                                       
[   5]        :                                       .MODEL small
[   6]        :                                       
[   7]        :                                       .STACK 512d
[   8]        :                                       
[   9]    0100: E9 BB 00                              .DATA
[  10]        :                                       
[  11]    0103: 54 79 70 65 20 61 20 6E 75 6D 62 65   readMsg1 db "Type a number to calculate the SquareRoot of it (Max: 65025):$"
                72 20 74 6F 20 63 61 6C 63 75 6C 61 
                74 65 20 74 68 65 20 53 71 75 61 72 
                65 52 6F 6F 74 20 6F 66 20 69 74 20 
                28 4D 61 78 3A 20 36 35 30 32 35 29 
                3A 24                               
[  12]    0141: 2A 20 44 65 63 69 6D 61 6C 20 70 72   readMsg2 db "* Decimal precision is not calculated for numbers greater than 654 *$"
                65 63 69 73 69 6F 6E 20 69 73 20 6E 
                6F 74 20 63 61 6C 63 75 6C 61 74 65 
                64 20 66 6F 72 20 6E 75 6D 62 65 72 
                73 20 67 72 65 61 74 65 72 20 74 68 
                61 6E 20 36 35 34 20 2A 24          
[  13]    0186: 43 61 6C 63 75 6C 61 74 69 6E 67 2E   loadingMsg db "Calculating...$"
                2E 2E 24                            
[  14]    0195: 41 76 65 72 61 67 65 20 53 71 75 61   resultMsg db "Average SquareRoot: $"
                72 65 52 6F 6F 74 3A 20 24          
[  15]    01AA: 00 00                                 source dw 0
[  16]    01AC: 00 00                                 aprx dw 0
[  17]    01AE: 00 00                                 aprxBuffer dw 0
[  18]    01B0: 00 00                                 aprxDec dw 0
[  19]    01B2: 00 00                                 aprxDecBuffer dw 0
[  20]    01B4: 00 00                                 stackTmp dw 0
[  21]    01B6: 00 00 00 00 00 00                     inputArray db 6 DUP(?)
[  22]    01BC: 00 00                                 charLength dw 0
[  23]        :                                       
[  24]        :                                       
[  25]    01BE:                                       .CODE
[  26]        :                                       
[  27]    01BE: E8 21 00                              call read
[  28]    01C1: A3 AA 01                              mov source, ax
[  29]        :                                       
[  30]        :                                       ; Printing loadingMsg
[  31]    01C4: E8 73 01                              call printCRLF
[  32]    01C7: B4 09                                 mov ah, 09
[  33]    01C9: BA 86 01                              lea dx, loadingMsg
[  34]    01CC: CD 21                                 int 21h
[  35]    01CE: BA 00 00                              mov dx, 0
[  36]        :                                       
[  37]    01D1: A1 AA 01                              mov ax, source
[  38]    01D4: E8 6B 00                              call calcSqrt
[  39]        :                                       
[  40]    01D7: A1 AC 01                              mov ax, aprx
[  41]    01DA: 8B 1E B0 01                           mov bx, aprxDec
[  42]    01DE: E8 E4 00                              call printSqrt
[  43]        :                                       
[  44]    01E1: C3                                    ret
[  45]        :                                       
[  46]        :                                       
[  47]        :                                       
[  48]    01E2:                                       read:
[  49]        :                                       
[  50]    01E2: 8F 06 B4 01                           pop stackTmp
[  51]        :                                       
[  52]        :                                       ; Printing readMsg1
[  53]    01E6: B4 09                                 mov ah, 09
[  54]    01E8: BA 03 01                              lea dx, readMsg1
[  55]    01EB: CD 21                                 int 21h
[  56]    01ED: BA 00 00                              mov dx, 0
[  57]        :                                       
[  58]    01F0: E8 47 01                              call printCRLF
[  59]        :                                       
[  60]        :                                       ; Printing readMsg2
[  61]    01F3: B4 09                                 mov ah, 09
[  62]    01F5: BA 41 01                              lea dx, readMsg2
[  63]    01F8: CD 21                                 int 21h
[  64]    01FA: BA 00 00                              mov dx, 0
[  65]        :                                       
[  66]    01FD: E8 3A 01                              call printCRLF
[  67]        :                                       
[  68]    0200: B4 02                                 mov ah, 02
[  69]    0202: B2 29                                 mov dl, 41
[  70]    0204: CD 21                                 int 21h
[  71]        :                                       
[  72]        :                                       
[  73]        :                                       
[  74]    0206: BE B6 01                              lea si, inputArray
[  75]    0209: B9 06 00                              mov cx, 6
[  76]    020C:                                       readLoop:
[  77]        :                                       
[  78]    020C: B4 01                                 mov ah, 01
[  79]    020E: CD 21                                 int 21h
[  80]        :                                       
[  81]    0210: 3C 0D                                 cmp al, 13
[  82]    0212: 74 0D                                 je fnshRead
[  83]        :                                       
[  84]    0214: B4 00                                 mov ah, 0
[  85]    0216: 2C 30                                 sub al, 48
[  86]    0218: 89 04                                 mov [si], ax
[  87]    021A: 46                                    inc si
[  88]        :                                       
[  89]    021B: FF 06 BC 01                           inc charLength
[  90]        :                                       
[  91]    021F: E2 EB                                 Loop readLoop:
[  92]    0221:                                       fnshRead:
[  93]        :                                       
[  94]    0221: BE B6 01                              lea si, inputArray
[  95]    0224: 8B 0E BC 01                           mov cx, charLength
[  96]    0228: BA 00 00                              mov dx, 0
[  97]    022B:                                       convertLoop:
[  98]        :                                       
[  99]    022B: B8 0A 00                              mov ax, 10
[ 100]    022E: F7 E2                                 mul dx ; AX = DX * 10
[ 101]        :                                       
[ 102]    0230: 8B 1C                                 mov bx, [si]
[ 103]    0232: B7 00                                 mov bh, 0
[ 104]    0234: 46                                    inc si
[ 105]    0235: 03 C3                                 add ax, bx ; AX = (DX * 10) + BX
[ 106]        :                                       
[ 107]    0237: 8B D0                                 mov dx, ax
[ 108]        :                                       
[ 109]    0239: E2 F0                                 Loop convertLoop
[ 110]    023B:                                       fnshConvert:
[ 111]    023B: 8B C2                                 mov ax, dx
[ 112]        :                                       
[ 113]    023D: FF 36 B4 01                           push stackTmp
[ 114]    0241: C3                                    ret
[ 115]        :                                       
[ 116]        :                                       ; Calculates the Sqrt of a 16 bit integer
[ 117]        :                                       ; @arg: source -> AX
[ 118]        :                                       ; @returns: integer result -> AX, decimal result -> BX
[ 119]    0242:                                       calcSqrt:
[ 120]        :                                       
[ 121]    0242: 8F 06 B4 01                           pop stackTmp
[ 122]        :                                       
[ 123]        :                                       ; aprox = (source / 200) + 2
[ 124]    0246: BB C8 00                              mov bx, 200
[ 125]    0249: 33 D2                                 xor dx, dx
[ 126]    024B: F7 F3                                 div bx
[ 127]    024D: 05 02 00                              add ax, 2
[ 128]    0250: A3 AC 01                              mov aprx, ax
[ 129]        :                                       
[ 130]    0253:                                       calcLoop:
[ 131]    0253: 8B 16 AA 01                           mov dx, source
[ 132]    0257: 8B 1E AC 01                           mov bx, aprx
[ 133]        :                                       
[ 134]        :                                       ; If aprox == aproxBuffer it means that the squareroot of source
[ 135]        :                                       ;  is a floating point number, which is not supported by the 8068
[ 136]        :                                       ;  and thus, can't be calculated precisely.
[ 137]    025B: 3B 1E AE 01                           cmp bx, aprxBuffer
[ 138]    025F: 74 02                                 je testDecimal
[ 139]    0261: EB 06                                 jmp continueSqrt
[ 140]    0263:                                       testDecimal:
[ 141]    0263: 3B 06 B2 01                           cmp ax, aprxDecBuffer
[ 142]    0267: 74 57                                 je fnshAvrgSqrt
[ 143]    0269:                                       continueSqrt:
[ 144]    0269: 89 1E AE 01                           mov aprxBuffer, bx
[ 145]    026D: A3 B2 01                              mov aprxDecBuffer, ax
[ 146]        :                                       
[ 147]        :                                       ; checking if aprox² == source
[ 148]    0270: 8B C3                                 mov ax, bx
[ 149]    0272: 33 D2                                 xor dx, dx
[ 150]    0274: F7 E3                                 mul bx
[ 151]    0276: 3B 06 AA 01                           cmp ax, source
[ 152]    027A: 74 3B                                 je fnshSqrt
[ 153]        :                                       
[ 154]        :                                       ; aprox = ((source / aprox) + aprox) / 2
[ 155]    027C: A1 AA 01                              mov ax, source
[ 156]    027F: 8B 1E AC 01                           mov bx, aprx
[ 157]    0283: 33 D2                                 xor dx, dx
[ 158]    0285: F7 F3                                 div bx
[ 159]    0287: 03 06 AC 01                           add ax, aprx
[ 160]    028B: D1 E8                                 shr ax, 1
[ 161]    028D: A3 AC 01                              mov aprx, ax
[ 162]        :                                       
[ 163]    0290: BA 64 00                              mov dx, 100
[ 164]    0293: F7 E2                                 mul dx
[ 165]    0295: 50                                    push ax
[ 166]        :                                       
[ 167]        :                                       ; aprox = ((source * 100 / aprx) + aprx * 100) / 2
[ 168]    0296: A1 AA 01                              mov ax, source
[ 169]    0299: BA 64 00                              mov dx, 100
[ 170]    029C: F7 E2                                 mul dx ; source * 100
[ 171]        :                                       
[ 172]    029E: 33 D2                                 xor dx, dx ; DX = 0
[ 173]    02A0: F7 F3                                 div bx ; (source * 100 / aprox)
[ 174]    02A2: 8B C8                                 mov cx, ax
[ 175]        :                                       
[ 176]    02A4: B8 64 00                              mov ax, 100
[ 177]    02A7: 33 D2                                 xor dx, dx
[ 178]    02A9: F7 E3                                 mul bx ; (aprx * 100)
[ 179]        :                                       
[ 180]    02AB: 03 C1                                 add ax, cx ; (source * 100 / aprx) + aprx * 100)
[ 181]    02AD: D1 E8                                 shr ax, 1 ; ((source * 100 / aprx) + aprx * 100) / 2
[ 182]        :                                       
[ 183]    02AF: 59                                    pop cx ; CX = aprx (current) * 100
[ 184]    02B0: 2B C1                                 sub ax, cx ; (((source * 100 / aprx) + aprx * 100) / 2) - aprx * 100
[ 185]        :                                       
[ 186]    02B2: A3 B0 01                              mov aprxDec, ax
[ 187]        :                                       
[ 188]    02B5: EB 9C                                 JMP calcLoop
[ 189]        :                                       
[ 190]        :                                       ; The result is an integer number
[ 191]    02B7:                                       fnshSqrt:
[ 192]    02B7: BB 00 00                              mov bx, 0
[ 193]    02BA: C7 06 B0 01 00 00                     mov aprxDec, 0
[ 194]        :                                       
[ 195]        :                                       ; The result is the lower round of a floating point number
[ 196]    02C0:                                       fnshAvrgSqrt:
[ 197]        :                                       
[ 198]        :                                       
[ 199]        :                                       
[ 200]    02C0: FF 36 B4 01                           push stackTmp
[ 201]        :                                       
[ 202]    02C4: C3                                    ret
[ 203]        :                                       
[ 204]    02C5:                                       printSqrt:
[ 205]        :                                       
[ 206]    02C5: 53                                    push bx
[ 207]    02C6: 50                                    push ax
[ 208]        :                                       
[ 209]    02C7: E8 70 00                              call printCRLF
[ 210]        :                                       
[ 211]    02CA: B4 09                                 mov ah, 09
[ 212]    02CC: BA 95 01                              lea dx, resultMsg
[ 213]    02CF: CD 21                                 int 21h
[ 214]    02D1: BA 00 00                              mov dx, 0
[ 215]        :                                       
[ 216]    02D4: 58                                    pop ax
[ 217]    02D5: 5B                                    pop bx
[ 218]        :                                       
[ 219]    02D6: E8 14 00                              call printNumber
[ 220]        :                                       
[ 221]    02D9: 81 3E AA 01 8F 02                     cmp source, 655
[ 222]    02DF: 73 0B                                 jae fnshPrintSqrt
[ 223]        :                                       
[ 224]    02E1: B4 02                                 mov ah, 02
[ 225]    02E3: B2 2E                                 mov dl, 46
[ 226]    02E5: CD 21                                 int 21h
[ 227]        :                                       
[ 228]    02E7: 8B C3                                 mov ax, bx
[ 229]    02E9: E8 01 00                              call printNumber
[ 230]        :                                       
[ 231]    02EC:                                       fnshPrintSqrt:
[ 232]    02EC: C3                                    ret
[ 233]        :                                       
[ 234]        :                                       
[ 235]    02ED:                                       printNumber:
[ 236]        :                                       
[ 237]    02ED: 3D 64 00                              cmp ax, 100
[ 238]    02F0: 73 23                                 jae printThreeDigits
[ 239]    02F2: 3D 0A 00                              cmp ax, 10
[ 240]    02F5: 73 0A                                 jae printTwoDigits
[ 241]        :                                       
[ 242]        :                                       ; 1 digit:
[ 243]    02F7:                                       printOneDigit:
[ 244]        :                                       
[ 245]    02F7: B4 02                                 mov ah, 02
[ 246]    02F9: 8A D0                                 mov dl, al
[ 247]    02FB: 80 C2 30                              add dl, 48
[ 248]    02FE: CD 21                                 int 21h
[ 249]    0300: C3                                    ret
[ 250]        :                                       
[ 251]        :                                       ; 2 digits:
[ 252]    0301:                                       printTwoDigits:
[ 253]    0301: D4 0A                                 aam
[ 254]    0303: 80 C4 30                              add ah, 48
[ 255]    0306: 04 30                                 add al, 48
[ 256]        :                                       
[ 257]    0308: 8B C8                                 mov cx, ax
[ 258]    030A: B4 02                                 mov ah, 02
[ 259]        :                                       
[ 260]    030C: 8A D5                                 mov dl, ch
[ 261]    030E: CD 21                                 int 21h
[ 262]        :                                       
[ 263]        :                                       
[ 264]        :                                       
[ 265]    0310: 8A D1                                 mov dl, cl
[ 266]    0312: CD 21                                 int 21h
[ 267]    0314: C3                                    ret
[ 268]        :                                       
[ 269]        :                                       ; 3 digits:
[ 270]    0315:                                       printThreeDigits:
[ 271]    0315: 53                                    push bx
[ 272]        :                                       
[ 273]    0316: D4 0A                                 aam
[ 274]    0318: 8A F0                                 mov dh, al
[ 275]    031A: 8A C4                                 mov al, ah
[ 276]    031C: B4 00                                 mov ah, 0
[ 277]    031E: D4 0A                                 aam
[ 278]        :                                       
[ 279]    0320: 80 C4 30                              add ah, 48
[ 280]    0323: 04 30                                 add al, 48
[ 281]    0325: 80 C6 30                              add dh, 48
[ 282]        :                                       
[ 283]    0328: 8B C8                                 mov cx, ax
[ 284]    032A: B4 02                                 mov ah, 02
[ 285]        :                                       
[ 286]    032C: 8A D5                                 mov dl, ch
[ 287]    032E: CD 21                                 int 21h
[ 288]        :                                       
[ 289]    0330: 8A D1                                 mov dl, cl
[ 290]    0332: CD 21                                 int 21h
[ 291]        :                                       
[ 292]    0334: 8A D6                                 mov dl, dh
[ 293]    0336: CD 21                                 int 21h
[ 294]        :                                       
[ 295]    0338: 5B                                    pop bx
[ 296]    0339: C3                                    ret
[ 297]        :                                       
[ 298]        :                                       ; Printing CRLF (carriage return + line feed)
[ 299]    033A:                                       printCRLF:
[ 300]        :                                       
[ 301]    033A: B4 02                                 mov ah, 02
[ 302]    033C: B2 0D                                 mov dl, 13
[ 303]    033E: CD 21                                 int 21h
[ 304]    0340: B2 0A                                 mov dl, 10
[ 305]    0342: CD 21                                 int 21h
[ 306]    0344: C3                                    ret
[ 307]        :                                       
 
===================================================================================================
 




===================================================================================================
